# PTFI_Task_2
## Introduction
This is new integrated Federated Learning model of Privacy Technologies for Financial Intelligence (PTFI[1]), which is a Data Bytes Company project and available in https://github.com/DataBytes-Organisation/Privacy-Technologies-for-Financial-Intelligence. The specific task plan is shown in the following document:
- [Integrated_Federated_Learning_1st.pdf](https://github.com/liuchuang00/PTFI_Task_2/blob/master/Integrated_Federated_Learning_1st.pdf)


## Structure
***1. Dataset***  
we analyze a new financial relationship (Bank Loans). Primarily, financial analysis is performed using the Loan dataset[2] generated by CTAB-GAN+[3]. The datasets files are as follows:     
  - [Loan_fake_Task2_0.csv~Loan_fake_Task2_21.csv](https://github.com/liuchuang00/PTFI_Task_2/tree/master/Task%202/FL/data/Loan)  

After the data is scrambled and integrated, the client data set and the test data set are formed. The datasets files are as follows:  
  - [Client0.csv~Client9.csv](https://github.com/liuchuang00/PTFI_Task_2/tree/master/Task%202/FL/data/Loan)        
  - [test.csv](https://github.com/liuchuang00/PTFI_Task_2/blob/master/Task%202/FL/data/Loan/test.csv)   

Local procedures for shuffling and consolidating data are as follows:   
  - [dataset_merging.py](https://github.com/liuchuang00/PTFI_Task_2/blob/master/Task%202/FL/data/Loan/dataset_merging.py)        

***2. Model and Demonstration***    
We integrate meta-learning[4], personalization layers[5], and FedAvg[6] into the federated learning model. See the following program for specific implementation:       
  - [args.py](https://github.com/liuchuang00/PTFI_Task_2/tree/master/Task%202/FL/args.py)   
  - [client.py](https://github.com/liuchuang00/PTFI_Task_2/tree/master/Task%202/FL/client.py)    
  - [dataset.py](https://github.com/liuchuang00/PTFI_Task_2/tree/master/Task%202/FL/dataset.py)   
  - [model.py](https://github.com/liuchuang00/PTFI_Task_2/tree/master/Task%202/FL/model.py)   
  - [server.py](https://github.com/liuchuang00/PTFI_Task_2/tree/master/Task%202/FL/server.py)   
  - [visualization.py](https://github.com/liuchuang00/PTFI_Task_2/tree/master/Task%202/FL/visualization.py)   
   
The demo is divided into local demo and notebook demo, and the files are as follows:    
  - [demonstration.ipynb](https://github.com/liuchuang00/PTFI_Task_2/tree/master/Task%202/FL/demonstration.ipynb)   
  - [main.py](https://github.com/liuchuang00/PTFI_Task_2/tree/master/Task%202/FL/main.py)   


***3. Meta-Learning Parameters***    
After meta-learning training, we get the parameters of the initial model. The client models parameter file is as follows:     
  - [client0.pth~client9.pth](https://github.com/liuchuang00/PTFI_Task_2/tree/master/Task%202/FL/meta_parameters)

The server model parameter file is as follows:
  - [server.pth](https://github.com/liuchuang00/PTFI_Task_2/blob/master/Task%202/FL/meta_parameters/server.pth)
    
***4. Integrated Fl Model Parameters***   
After training the personalization layer federation learning model, we get integrated Fl model parameters. The client models parameter file is as follows:     
  - [client0.pth~client9.pth](https://github.com/liuchuang00/PTFI_Task_2/tree/master/Task%202/FL/FL_parameters)   

The server model parameter file is as follows:
  - [server.pth](https://github.com/liuchuang00/PTFI_Task_2/blob/master/Task%202/FL/FL_parameters/server.pth)

***Note:*** Part of the code is taken from https://github.com/ki-ljl/Per-FedAvg[7].   
## Reference
[1] PTFI (2024). Privacy-Technologies-for-Financial-Intelligence [Website]. Github Repository. Available: https://github.com/DataBytes-Organisation/Privacy-Technologies-for-Financial-Intelligence.     
[2] Sunil Jacob (2024). Bank_Loan_modelling [Dataset]. Kaggle Repository. Available: https://www.kaggle.com/datasets/itsmesunil/bank-loan-modelling/data   
[3] Z. Zhao, A. Kunar, R. Birke, H. Van der Scheer, and L. Y. Chen, “CTAB-GAN+: Enhancing Tabular Data Synthesis,” Frontiers in big Data, vol. 6, p. 1296508, 2024.   
[4] A. Fallah, A. Mokhtari, and A. Ozdaglar, “Personalized Federated Learning: A Meta-Learning Approach,” arXiv preprint arXiv:2002.07948, 2020.   
[5] M. G. Arivazhagan, V. Aggarwal, A. K. Singh, and S. Choudhary, “Federated Learning with Personalization Layers,” arXiv preprint arXiv:1912.00818, 2019.    
[6] B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas, “Communication-Efficient Learning of Deep Networks from Decentralized Data,” in Artificial intelligence and statistics. PMLR, 2017, pp. 1273–1282.     
[7] J. H. Li (2024). Per-FedAvg[Online]. Github Repository. Available: https://github.com/ki-ljl/Per-FedAvg.

**Time** ： 09/12/2024  
**Author** ： Chuang Liu   
**Email** ：LIUC0316@126.COM     
